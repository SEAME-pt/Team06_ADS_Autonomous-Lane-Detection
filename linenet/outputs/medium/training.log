2025-06-04 11:42:34,302 - INFO - Starting training experiment: medium
2025-06-04 11:42:34,302 - INFO - Arguments: {'train_images': '/home/djoker/code/cuda/mixdataset/images', 'train_masks': '/home/djoker/code/cuda/mixdataset/masks', 'val_images': None, 'val_masks': None, 'val_split': 0.2, 'variant': 'medium', 'input_channels': 3, 'num_classes': 1, 'epochs': 200, 'batch_size': 4, 'learning_rate': 0.0003, 'weight_decay': 0.0001, 'image_size': [224, 224], 'bce_weight': 0.5, 'dice_weight': 0.3, 'focal_weight': 0.2, 'output_dir': './outputs', 'experiment_name': 'medium', 'save_every': 5, 'visualize_every': 2, 'resume': None, 'device': 'auto', 'use_wandb': False, 'wandb_project': 'linenet'}
2025-06-04 11:42:34,545 - INFO - Model info: {'variant': 'medium', 'total_params': 6824417, 'trainable_params': 6824417, 'model_size_mb': 26.033084869384766}
2025-06-04 11:42:34,565 - INFO - Training samples: 930
2025-06-04 11:42:34,565 - INFO - Validation samples: 232
2025-06-04 11:42:35,273 - INFO - Starting training...
2025-06-04 11:42:35,273 - INFO - 
Epoch 1/200
2025-06-04 11:42:35,273 - INFO - Learning rate: 0.000300
2025-06-04 11:43:44,757 - INFO - Train Loss: 0.2899, Val Loss: 0.2392
2025-06-04 11:43:44,757 - INFO - Train IoU: 0.1846, Val IoU: 0.2564
2025-06-04 11:43:44,757 - INFO - Train Dice: 0.2951, Val Dice: 0.3993
2025-06-04 11:43:44,757 - INFO - Train F1: 0.2951, Val F1: 0.3993
2025-06-04 11:43:44,942 - INFO - New best model saved! IoU: 0.2564
2025-06-04 11:43:44,942 - INFO - 
Epoch 2/200
2025-06-04 11:43:44,942 - INFO - Learning rate: 0.000142
2025-06-04 11:44:53,869 - INFO - Train Loss: 0.2207, Val Loss: 0.2244
2025-06-04 11:44:53,869 - INFO - Train IoU: 0.2993, Val IoU: 0.2796
2025-06-04 11:44:53,869 - INFO - Train Dice: 0.4519, Val Dice: 0.4269
2025-06-04 11:44:53,869 - INFO - Train F1: 0.4519, Val F1: 0.4269
2025-06-04 11:44:54,249 - INFO - New best model saved! IoU: 0.2796
2025-06-04 11:44:56,936 - INFO - Visualizations saved: outputs/medium/predictions_epoch_2.png
2025-06-04 11:44:56,936 - INFO - 
Epoch 3/200
2025-06-04 11:44:56,936 - INFO - Learning rate: 0.000156
2025-06-04 11:46:06,006 - INFO - Train Loss: 0.2044, Val Loss: 0.2204
2025-06-04 11:46:06,006 - INFO - Train IoU: 0.3326, Val IoU: 0.2891
2025-06-04 11:46:06,006 - INFO - Train Dice: 0.4909, Val Dice: 0.4392
2025-06-04 11:46:06,006 - INFO - Train F1: 0.4909, Val F1: 0.4392
2025-06-04 11:46:06,391 - INFO - New best model saved! IoU: 0.2891
2025-06-04 11:46:06,391 - INFO - 
Epoch 4/200
2025-06-04 11:46:06,392 - INFO - Learning rate: 0.000292
2025-06-04 11:47:15,470 - INFO - Train Loss: 0.2001, Val Loss: 0.2122
2025-06-04 11:47:15,470 - INFO - Train IoU: 0.3431, Val IoU: 0.3114
2025-06-04 11:47:15,470 - INFO - Train Dice: 0.5032, Val Dice: 0.4647
2025-06-04 11:47:15,470 - INFO - Train F1: 0.5032, Val F1: 0.4647
2025-06-04 11:47:15,828 - INFO - New best model saved! IoU: 0.3114
2025-06-04 11:47:18,402 - INFO - Visualizations saved: outputs/medium/predictions_epoch_4.png
2025-06-04 11:47:18,402 - INFO - 
Epoch 5/200
2025-06-04 11:47:18,402 - INFO - Learning rate: 0.000164
2025-06-04 11:48:27,518 - INFO - Train Loss: 0.1836, Val Loss: 0.1997
2025-06-04 11:48:27,518 - INFO - Train IoU: 0.3797, Val IoU: 0.3382
2025-06-04 11:48:27,518 - INFO - Train Dice: 0.5422, Val Dice: 0.4963
2025-06-04 11:48:27,518 - INFO - Train F1: 0.5422, Val F1: 0.4963
2025-06-04 11:48:27,937 - INFO - New best model saved! IoU: 0.3382
2025-06-04 11:48:28,136 - INFO - Checkpoint saved: outputs/medium/checkpoint_epoch_5.pth
2025-06-04 11:48:30,565 - INFO - 
Epoch 6/200
2025-06-04 11:48:30,565 - INFO - Learning rate: 0.000020
2025-06-04 11:49:39,643 - INFO - Train Loss: 0.1872, Val Loss: 0.2083
2025-06-04 11:49:39,643 - INFO - Train IoU: 0.3748, Val IoU: 0.3225
2025-06-04 11:49:39,643 - INFO - Train Dice: 0.5363, Val Dice: 0.4788
2025-06-04 11:49:39,643 - INFO - Train F1: 0.5362, Val F1: 0.4788
2025-06-04 11:49:42,495 - INFO - Visualizations saved: outputs/medium/predictions_epoch_6.png
2025-06-04 11:49:42,495 - INFO - 
Epoch 7/200
2025-06-04 11:49:42,495 - INFO - Learning rate: 0.000293
2025-06-04 11:50:51,577 - INFO - Train Loss: 0.1845, Val Loss: 0.2007
2025-06-04 11:50:51,578 - INFO - Train IoU: 0.3778, Val IoU: 0.3394
2025-06-04 11:50:51,578 - INFO - Train Dice: 0.5404, Val Dice: 0.4986
2025-06-04 11:50:51,578 - INFO - Train F1: 0.5404, Val F1: 0.4986
2025-06-04 11:50:51,907 - INFO - New best model saved! IoU: 0.3394
2025-06-04 11:50:51,907 - INFO - 
Epoch 8/200
2025-06-04 11:50:51,907 - INFO - Learning rate: 0.000245
2025-06-04 11:52:00,842 - INFO - Train Loss: 0.1776, Val Loss: 0.2042
2025-06-04 11:52:00,842 - INFO - Train IoU: 0.3946, Val IoU: 0.3387
2025-06-04 11:52:00,842 - INFO - Train Dice: 0.5574, Val Dice: 0.4973
2025-06-04 11:52:00,842 - INFO - Train F1: 0.5574, Val F1: 0.4973
2025-06-04 11:52:03,327 - INFO - Visualizations saved: outputs/medium/predictions_epoch_8.png
2025-06-04 11:52:03,327 - INFO - 
Epoch 9/200
2025-06-04 11:52:03,327 - INFO - Learning rate: 0.000167
2025-06-04 11:53:12,410 - INFO - Train Loss: 0.1662, Val Loss: 0.1922
2025-06-04 11:53:12,410 - INFO - Train IoU: 0.4227, Val IoU: 0.3558
2025-06-04 11:53:12,410 - INFO - Train Dice: 0.5877, Val Dice: 0.5157
2025-06-04 11:53:12,410 - INFO - Train F1: 0.5877, Val F1: 0.5157
2025-06-04 11:53:12,734 - INFO - New best model saved! IoU: 0.3558
2025-06-04 11:53:12,734 - INFO - 
Epoch 10/200
2025-06-04 11:53:12,735 - INFO - Learning rate: 0.000084
2025-06-04 11:54:21,759 - INFO - Train Loss: 0.1575, Val Loss: 0.1883
2025-06-04 11:54:21,759 - INFO - Train IoU: 0.4450, Val IoU: 0.3667
2025-06-04 11:54:21,760 - INFO - Train Dice: 0.6084, Val Dice: 0.5274
2025-06-04 11:54:21,760 - INFO - Train F1: 0.6084, Val F1: 0.5274
2025-06-04 11:54:22,149 - INFO - New best model saved! IoU: 0.3667
2025-06-04 11:54:22,345 - INFO - Checkpoint saved: outputs/medium/checkpoint_epoch_10.pth
2025-06-04 11:54:24,837 - INFO - Visualizations saved: outputs/medium/predictions_epoch_10.png
2025-06-04 11:54:27,145 - INFO - 
Epoch 11/200
2025-06-04 11:54:27,145 - INFO - Learning rate: 0.000022
2025-06-04 11:55:36,059 - INFO - Train Loss: 0.1528, Val Loss: 0.1928
2025-06-04 11:55:36,059 - INFO - Train IoU: 0.4568, Val IoU: 0.3535
2025-06-04 11:55:36,059 - INFO - Train Dice: 0.6199, Val Dice: 0.5126
2025-06-04 11:55:36,059 - INFO - Train F1: 0.6199, Val F1: 0.5126
2025-06-04 11:55:36,059 - INFO - 
Epoch 12/200
2025-06-04 11:55:36,059 - INFO - Learning rate: 0.000300
2025-06-04 11:56:45,125 - INFO - Train Loss: 0.1748, Val Loss: 0.1998
2025-06-04 11:56:45,125 - INFO - Train IoU: 0.4023, Val IoU: 0.3363
2025-06-04 11:56:45,125 - INFO - Train Dice: 0.5652, Val Dice: 0.4937
2025-06-04 11:56:45,126 - INFO - Train F1: 0.5652, Val F1: 0.4937
2025-06-04 11:56:47,686 - INFO - Visualizations saved: outputs/medium/predictions_epoch_12.png
2025-06-04 11:56:47,686 - INFO - 
Epoch 13/200
2025-06-04 11:56:47,686 - INFO - Learning rate: 0.000293
2025-06-04 11:57:56,729 - INFO - Train Loss: 0.1665, Val Loss: 0.1905
2025-06-04 11:57:56,729 - INFO - Train IoU: 0.4218, Val IoU: 0.3634
2025-06-04 11:57:56,729 - INFO - Train Dice: 0.5853, Val Dice: 0.5250
2025-06-04 11:57:56,729 - INFO - Train F1: 0.5853, Val F1: 0.5250
2025-06-04 11:57:56,729 - INFO - 
Epoch 14/200
2025-06-04 11:57:56,729 - INFO - Learning rate: 0.000275
2025-06-04 11:59:05,723 - INFO - Train Loss: 0.1612, Val Loss: 0.1882
2025-06-04 11:59:05,723 - INFO - Train IoU: 0.4357, Val IoU: 0.3710
2025-06-04 11:59:05,723 - INFO - Train Dice: 0.5997, Val Dice: 0.5324
2025-06-04 11:59:05,723 - INFO - Train F1: 0.5997, Val F1: 0.5324
2025-06-04 11:59:06,147 - INFO - New best model saved! IoU: 0.3710
2025-06-04 11:59:08,705 - INFO - Visualizations saved: outputs/medium/predictions_epoch_14.png
2025-06-04 11:59:08,705 - INFO - 
Epoch 15/200
2025-06-04 11:59:08,705 - INFO - Learning rate: 0.000246
2025-06-04 12:00:17,240 - INFO - Train Loss: 0.1530, Val Loss: 0.1881
2025-06-04 12:00:17,241 - INFO - Train IoU: 0.4547, Val IoU: 0.3710
2025-06-04 12:00:17,241 - INFO - Train Dice: 0.6176, Val Dice: 0.5329
2025-06-04 12:00:17,241 - INFO - Train F1: 0.6176, Val F1: 0.5329
2025-06-04 12:00:17,430 - INFO - Checkpoint saved: outputs/medium/checkpoint_epoch_15.pth
2025-06-04 12:00:20,000 - INFO - 
Epoch 16/200
2025-06-04 12:00:20,001 - INFO - Learning rate: 0.000210
2025-06-04 12:01:28,463 - INFO - Train Loss: 0.1460, Val Loss: 0.1850
2025-06-04 12:01:28,463 - INFO - Train IoU: 0.4739, Val IoU: 0.3765
2025-06-04 12:01:28,463 - INFO - Train Dice: 0.6354, Val Dice: 0.5380
2025-06-04 12:01:28,463 - INFO - Train F1: 0.6354, Val F1: 0.5380
2025-06-04 12:01:28,823 - INFO - New best model saved! IoU: 0.3765
2025-06-04 12:01:31,235 - INFO - Visualizations saved: outputs/medium/predictions_epoch_16.png
2025-06-04 12:01:31,235 - INFO - 
Epoch 17/200
2025-06-04 12:01:31,235 - INFO - Learning rate: 0.000169
2025-06-04 12:02:39,565 - INFO - Train Loss: 0.1386, Val Loss: 0.1819
2025-06-04 12:02:39,565 - INFO - Train IoU: 0.4929, Val IoU: 0.3815
2025-06-04 12:02:39,566 - INFO - Train Dice: 0.6536, Val Dice: 0.5430
2025-06-04 12:02:39,566 - INFO - Train F1: 0.6536, Val F1: 0.5430
2025-06-04 12:02:39,947 - INFO - New best model saved! IoU: 0.3815
2025-06-04 12:02:39,947 - INFO - 
Epoch 18/200
2025-06-04 12:02:39,948 - INFO - Learning rate: 0.000127
2025-06-04 12:03:48,441 - INFO - Train Loss: 0.1295, Val Loss: 0.1829
2025-06-04 12:03:48,441 - INFO - Train IoU: 0.5199, Val IoU: 0.3856
2025-06-04 12:03:48,441 - INFO - Train Dice: 0.6773, Val Dice: 0.5476
2025-06-04 12:03:48,442 - INFO - Train F1: 0.6773, Val F1: 0.5476
2025-06-04 12:03:48,814 - INFO - New best model saved! IoU: 0.3856
2025-06-04 12:03:51,285 - INFO - Visualizations saved: outputs/medium/predictions_epoch_18.png
2025-06-04 12:03:51,285 - INFO - 
Epoch 19/200
2025-06-04 12:03:51,285 - INFO - Learning rate: 0.000086
2025-06-04 12:05:00,496 - INFO - Train Loss: 0.1242, Val Loss: 0.1823
2025-06-04 12:05:00,496 - INFO - Train IoU: 0.5339, Val IoU: 0.3828
2025-06-04 12:05:00,496 - INFO - Train Dice: 0.6899, Val Dice: 0.5444
2025-06-04 12:05:00,497 - INFO - Train F1: 0.6899, Val F1: 0.5444
2025-06-04 12:05:00,497 - INFO - 
Epoch 20/200
2025-06-04 12:05:00,497 - INFO - Learning rate: 0.000051
2025-06-04 12:06:11,761 - INFO - Train Loss: 0.1161, Val Loss: 0.1834
2025-06-04 12:06:11,761 - INFO - Train IoU: 0.5586, Val IoU: 0.3819
2025-06-04 12:06:11,761 - INFO - Train Dice: 0.7115, Val Dice: 0.5433
2025-06-04 12:06:11,761 - INFO - Train F1: 0.7115, Val F1: 0.5433
2025-06-04 12:06:11,982 - INFO - Checkpoint saved: outputs/medium/checkpoint_epoch_20.pth
2025-06-04 12:06:15,012 - INFO - Visualizations saved: outputs/medium/predictions_epoch_20.png
2025-06-04 12:06:17,868 - INFO - 
Epoch 21/200
2025-06-04 12:06:17,868 - INFO - Learning rate: 0.000023
2025-06-04 12:07:28,842 - INFO - Train Loss: 0.1135, Val Loss: 0.1843
2025-06-04 12:07:28,842 - INFO - Train IoU: 0.5665, Val IoU: 0.3821
2025-06-04 12:07:28,842 - INFO - Train Dice: 0.7173, Val Dice: 0.5436
2025-06-04 12:07:28,842 - INFO - Train F1: 0.7173, Val F1: 0.5436
2025-06-04 12:07:28,843 - INFO - 
Epoch 22/200
2025-06-04 12:07:28,843 - INFO - Learning rate: 0.000006
2025-06-04 12:08:37,874 - INFO - Train Loss: 0.1099, Val Loss: 0.1926
2025-06-04 12:08:37,874 - INFO - Train IoU: 0.5785, Val IoU: 0.3610
2025-06-04 12:08:37,874 - INFO - Train Dice: 0.7278, Val Dice: 0.5209
2025-06-04 12:08:37,874 - INFO - Train F1: 0.7278, Val F1: 0.5209
2025-06-04 12:08:40,355 - INFO - Visualizations saved: outputs/medium/predictions_epoch_22.png
2025-06-04 12:08:40,355 - INFO - 
Epoch 23/200
2025-06-04 12:08:40,355 - INFO - Learning rate: 0.000300
2025-06-04 12:09:54,065 - INFO - Train Loss: 0.1385, Val Loss: 0.1931
2025-06-04 12:09:54,066 - INFO - Train IoU: 0.4925, Val IoU: 0.3615
2025-06-04 12:09:54,066 - INFO - Train Dice: 0.6533, Val Dice: 0.5222
2025-06-04 12:09:54,066 - INFO - Train F1: 0.6533, Val F1: 0.5222
2025-06-04 12:09:54,066 - INFO - 
Epoch 24/200
2025-06-04 12:09:54,066 - INFO - Learning rate: 0.000298
2025-06-04 12:11:04,088 - INFO - Train Loss: 0.1420, Val Loss: 0.1870
2025-06-04 12:11:04,088 - INFO - Train IoU: 0.4821, Val IoU: 0.3710
2025-06-04 12:11:04,088 - INFO - Train Dice: 0.6442, Val Dice: 0.5321
2025-06-04 12:11:04,088 - INFO - Train F1: 0.6442, Val F1: 0.5321
2025-06-04 12:11:06,647 - INFO - Visualizations saved: outputs/medium/predictions_epoch_24.png
2025-06-04 12:11:06,647 - INFO - 
Epoch 25/200
2025-06-04 12:11:06,647 - INFO - Learning rate: 0.000294
2025-06-04 12:12:17,087 - INFO - Train Loss: 0.1363, Val Loss: 0.1864
2025-06-04 12:12:17,087 - INFO - Train IoU: 0.4975, Val IoU: 0.3759
2025-06-04 12:12:17,087 - INFO - Train Dice: 0.6589, Val Dice: 0.5373
2025-06-04 12:12:17,087 - INFO - Train F1: 0.6589, Val F1: 0.5373
2025-06-04 12:12:17,550 - INFO - Checkpoint saved: outputs/medium/checkpoint_epoch_25.pth
2025-06-04 12:12:20,137 - INFO - 
Epoch 26/200
2025-06-04 12:12:20,137 - INFO - Learning rate: 0.000286
2025-06-04 12:13:31,590 - INFO - Train Loss: 0.1268, Val Loss: 0.1847
2025-06-04 12:13:31,590 - INFO - Train IoU: 0.5254, Val IoU: 0.3773
2025-06-04 12:13:31,590 - INFO - Train Dice: 0.6827, Val Dice: 0.5387
2025-06-04 12:13:31,590 - INFO - Train F1: 0.6827, Val F1: 0.5387
2025-06-04 12:13:34,111 - INFO - Visualizations saved: outputs/medium/predictions_epoch_26.png
2025-06-04 12:13:34,111 - INFO - 
Epoch 27/200
2025-06-04 12:13:34,111 - INFO - Learning rate: 0.000275
2025-06-04 12:14:43,647 - INFO - Train Loss: 0.1224, Val Loss: 0.1877
2025-06-04 12:14:43,647 - INFO - Train IoU: 0.5387, Val IoU: 0.3677
2025-06-04 12:14:43,647 - INFO - Train Dice: 0.6941, Val Dice: 0.5287
2025-06-04 12:14:43,648 - INFO - Train F1: 0.6941, Val F1: 0.5287
2025-06-04 12:14:43,656 - INFO - Early stopping triggered at epoch 27
2025-06-04 12:14:46,032 - INFO - Training completed!
2025-06-04 12:14:46,032 - INFO - Best IoU achieved: 0.3856
2025-06-04 12:14:46,032 - INFO - Models saved in: outputs/medium
